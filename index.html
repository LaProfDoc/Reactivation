<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2299.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="fr"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;Cahier de Réactivation Centralisé&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>body { font-family: system-ui, sans-serif; background-color: #f5f5f5; color: #333; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.header { text-align: center; padding: 20px; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.header h1 { color: #005a9c; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>#loader { text-align: center; font-size: 1.2em; padding: 40px; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.disciplines-container {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-wrap: wrap;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.discipline-card {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 2px 8px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 300px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 15px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.discipline-card h2 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-bottom: 2px solid #eee;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn {</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.2s;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-reactivons { background-color: #007bff; color: white; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-reactivons:hover { background-color: #0056b3; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-add { background-color: #6c757d; color: white; text-decoration: none; display: inline-block; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-add:hover { background-color: #5a6268; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.question-zone {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #f8f9fa;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: left;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: none; /* Caché par défaut */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.question-text { font-weight: bold; margin-bottom: 10px; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.reactivation-buttons button { background-color: #ffc107; color: #333; margin: 2px; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.reactivation-date { margin-top: 10px; font-weight: bold; color: #d9534f; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h1&gt;Cahier de Réactivation&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p&gt;Cliquez sur "Réactivons !" pour afficher une question au hasard dans une matière.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="loader"&gt;Chargement des questions depuis la base de données...&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="disciplines-container" class="disciplines-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">document.addEventListener('DOMContentLoaded', () =&gt; {</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// ##################################################################</p>
<p class="p1"><span class="Apple-converted-space">    </span>// # ÉTAPE 1 : COLLEZ L'URL DE VOTRE GOOGLE SHEET PUBLIÉE EN .CSV</p>
<p class="p1"><span class="Apple-converted-space">    </span>// ##################################################################</p>
<p class="p1"><span class="Apple-converted-space">    </span>const GOOGLE_SHEET_URL_CSV = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS0gP4FjT8wplrDBpyV7aAm163_i7Ih6k9PzFCcaTE_QxMs2f2aTWXzBDWpo-lvs2HXFt0frPv1jSa_/pub?gid=0&amp;single=true&amp;output=csv';</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// ##################################################################</p>
<p class="p1"><span class="Apple-converted-space">    </span>// # ÉTAPE 2 : COLLEZ L'URL NORMALE DE VOTRE GOOGLE SHEET (POUR MODIFICATION)</p>
<p class="p1"><span class="Apple-converted-space">    </span>// ##################################################################</p>
<p class="p1"><span class="Apple-converted-space">    </span>const GOOGLE_SHEET_EDIT_URL = 'https://docs.google.com/spreadsheets/d/1NM7cTsTLSBsdLQRtmrtJppZ_TCltfSNIBX1qzgzV5Hk/edit?usp=sharing';</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const loader = document.getElementById('loader');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const container = document.getElementById('disciplines-container');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>if (GOOGLE_SHEET_URL_CSV === 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS0gP4FjT8wplrDBpyV7aAm163_i7Ih6k9PzFCcaTE_QxMs2f2aTWXzBDWpo-lvs2HXFt0frPv1jSa_/pub?gid=0&amp;single=true&amp;output=csv' || GOOGLE_SHEET_EDIT_URL === 'https://docs.google.com/spreadsheets/d/1NM7cTsTLSBsdLQRtmrtJppZ_TCltfSNIBX1qzgzV5Hk/edit?usp=sharing') {</p>
<p class="p1"><span class="Apple-converted-space">        </span>loader.innerHTML = "⚠️ ERREUR : Veuillez configurer les URLs de la Google Sheet dans le fichier HTML.";</p>
<p class="p1"><span class="Apple-converted-space">        </span>loader.style.color = 'red';</p>
<p class="p1"><span class="Apple-converted-space">        </span>return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>let allQuestions = [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Fonction pour charger et parser les données CSV</p>
<p class="p1"><span class="Apple-converted-space">    </span>async function loadData() {</p>
<p class="p1"><span class="Apple-converted-space">        </span>try {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const response = await fetch(GOOGLE_SHEET_URL_CSV);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const csvText = await response.text();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Conversion CSV en tableau d'objets JSON</p>
<p class="p1"><span class="Apple-converted-space">            </span>const lines = csvText.trim().split(/\r?\n/);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const headers = lines[0].split(',').map(h =&gt; h.trim());</p>
<p class="p1"><span class="Apple-converted-space">            </span>const data = lines.slice(1).map(line =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const values = line.split(',');</p>
<p class="p1"><span class="Apple-converted-space">                </span>let obj = {};</p>
<p class="p1"><span class="Apple-converted-space">                </span>headers.forEach((header, i) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>obj[header] = values[i] ? values[i].trim().replace(/"/g, '') : '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>return obj;</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>allQuestions = data;</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (allQuestions.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>buildUI();</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>loader.textContent = "Aucune question trouvée dans la base de données.";</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">           </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>console.error("Erreur de chargement des données:", error);</p>
<p class="p1"><span class="Apple-converted-space">            </span>loader.textContent = "Impossible de charger les questions. Vérifiez l'URL et les paramètres de publication de la Google Sheet.";</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Fonction pour construire l'interface utilisateur</p>
<p class="p1"><span class="Apple-converted-space">    </span>function buildUI() {</p>
<p class="p1"><span class="Apple-converted-space">        </span>loader.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">        </span>const disciplines = [...new Set(allQuestions.map(q =&gt; q.Discipline))];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>disciplines.forEach(discipline =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const card = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">            </span>card.className = 'discipline-card';</p>
<p class="p1"><span class="Apple-converted-space">            </span>card.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h2&gt;${discipline}&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button class="btn btn-reactivons" data-discipline="${discipline}"&gt;Réactivons !&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="question-zone"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="question-text"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="reactivation-buttons"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button class="btn" data-days="1"&gt;Réactivation 1&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button class="btn" data-days="7"&gt;Réactivation 2&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button class="btn" data-days="30"&gt;Réactivation 3&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="reactivation-date"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;a href="${GOOGLE_SHEET_EDIT_URL}" target="_blank" class="btn btn-add"&gt;Ajouter des questions&lt;/a&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>container.appendChild(card);</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>addEventListeners();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Fonction pour gérer les clics</p>
<p class="p1"><span class="Apple-converted-space">    </span>function addEventListeners() {</p>
<p class="p1"><span class="Apple-converted-space">        </span>container.querySelectorAll('.btn-reactivons').forEach(button =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>button.addEventListener('click', (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const discipline = e.target.dataset.discipline;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const questionsOfDiscipline = allQuestions.filter(q =&gt; q.Discipline === discipline);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (questionsOfDiscipline.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const randomQuestion = questionsOfDiscipline[Math.floor(Math.random() * questionsOfDiscipline.length)];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const card = e.target.closest('.discipline-card');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const questionZone = card.querySelector('.question-zone');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>questionZone.querySelector('.question-text').innerHTML = `&lt;strong&gt;Q :&lt;/strong&gt; ${randomQuestion.Question}&lt;br&gt;&lt;br&gt;&lt;strong&gt;R :&lt;/strong&gt; ${randomQuestion.Reponse}`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>questionZone.querySelector('.reactivation-date').textContent = ''; // Reset date</p>
<p class="p1"><span class="Apple-converted-space">                    </span>questionZone.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>container.querySelectorAll('.reactivation-buttons button').forEach(button =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>button.addEventListener('click', (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const days = parseInt(e.target.dataset.days, 10);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const reactivationDate = new Date();</p>
<p class="p1"><span class="Apple-converted-space">                </span>reactivationDate.setDate(reactivationDate.getDate() + days);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };</p>
<p class="p1"><span class="Apple-converted-space">                </span>const formattedDate = `Prochaine réactivation le ${reactivationDate.toLocaleDateString('fr-FR', options)}.`;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const dateP = e.target.closest('.question-zone').querySelector('.reactivation-date');</p>
<p class="p1"><span class="Apple-converted-space">                </span>dateP.textContent = formattedDate;</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Lancer le chargement</p>
<p class="p1"><span class="Apple-converted-space">    </span>loadData();</p>
<p class="p1">});</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
